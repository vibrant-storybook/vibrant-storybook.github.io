import{r as k,i as T,n as H,a as z,b as L,x as v,t as Y}from"./iframe-Bn05Qggx.js";import{e as E,C as F,M as b,S as O,O as W,W as _,a as M,E as $,b as V,c as D,A as U,D as y,G as S,T as B,P as G,d as Z,f as A,g as I,h as w,i as Q,j,k as N,L as R,B as q,V as g,l as m,Q as P,m as C,n as J}from"./OutputPass-CChwLA0t.js";import"./preload-helper-PPVm8Dsz.js";let X;function K(h){return(o,e)=>E(o,e,{get(){return(this.renderRoot??(X??=document.createDocumentFragment())).querySelectorAll(h)}})}const tt=":host{display:block;width:100%;position:relative;font-family:Poppins,sans-serif}.wrapper{position:relative;width:100%}.model-wrapper{position:sticky;top:0;height:100vh;width:100%;z-index:10}.vh-microsite-interactive-model{width:600px;height:600px;max-width:100%;max-height:100%;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);overflow:hidden}.vh-microsite-interactive-model canvas{display:block;width:100%!important;height:100%!important}.section{width:100%;min-height:100vh;scroll-snap-align:start;position:relative;z-index:1;pointer-events:none}.content-overlay{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:20}.controls-list{position:absolute;top:50%;left:40px;transform:translateY(-50%);display:flex;flex-direction:column;gap:24px;z-index:10;opacity:0;pointer-events:none;transition:opacity .6s ease}.controls-list.visible{opacity:1;pointer-events:auto}.control-item{background:transparent;border:none;padding:1px 30px 1px 1px;border-radius:50px;display:flex;align-items:center;gap:12px;cursor:pointer;transition:all .3s ease;text-align:left;outline:none;width:fit-content}.control-item .icon{width:24px;height:24px;display:flex;align-items:center;justify-content:center;opacity:1;transition:filter .3s ease}.control-item .icon img{width:100%;height:100%;display:block}.control-item .label{font-size:16px;color:#002c4e;opacity:.7;font-weight:500;transition:color .3s ease,opacity .3s ease}.control-item:hover .label{opacity:1}.control-item.active{background-color:#76b729}.control-item.active .icon{filter:brightness(0) invert(1)}.control-item.active .label{color:#fff;opacity:1;font-weight:600}.controls{position:absolute;top:50%;left:20px;transform:translateY(-50%);display:flex;flex-direction:column;gap:12px;z-index:10;pointer-events:none}.controls button{pointer-events:auto;padding:12px 24px;background:#ffffffe6;border:1px solid rgba(0,0,0,.1);border-radius:8px;font-family:Poppins,sans-serif;font-size:14px;color:#333;cursor:pointer;transition:all .2s ease;box-shadow:0 4px 6px #0000000d;font-weight:500;text-align:center;width:160px}.controls button:hover{background:#fff;transform:translate(4px);box-shadow:0 6px 12px #0000001a}.controls button:active{transform:translate(2px);box-shadow:0 2px 4px #0000000d}.info-card{position:absolute;top:40%;right:40px;transform:translateY(-60%);width:261px;background-color:#f0fdf4;border-radius:12px;padding:24px;box-shadow:0 4px 20px #0000000d;z-index:10;font-family:Poppins,sans-serif;opacity:0;pointer-events:none;transition:opacity .6s ease}.info-card.visible{opacity:1;pointer-events:auto}.info-card .card-header{display:flex;align-items:center;gap:10px;margin-bottom:12px}.info-card .card-header img{width:20px;height:20px;display:block}.info-card .card-header h3{margin:0;font-size:16px;font-weight:700;color:#002c4e}.info-card p{margin:0;font-size:14px;font-weight:300;line-height:1.5;color:#334155}",p=[{label:"Intro",view:"front",textAngle:0,modelRotationY:0,description:"",hidden:!0,isIdle:!0},{label:"Full Disclosure Labelling",view:"back",textAngle:0,modelRotationY:180,description:"Explore your favorite products—from ingredient functions and sources to version numbers and scientific support. Every label has a story, and we're not keeping it to ourselves, even if that means sharing our formulas with the world."},{label:"No Proprietary Blends",view:"front",textAngle:275,modelRotationY:220,description:"At Vibrant Health, we never use proprietary blends because we believe you deserve to know exactly what’s in your supplements. Full transparency empowers you to make confident, informed choices about your health."},{label:"Non GMO Certified",view:"left",textAngle:200,modelRotationY:90,description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam nec metus nec ante placerat finibus."},{label:"Clinically Formulated",view:"left",textAngle:127,modelRotationY:350,description:"Our products are clinically formulated using science-backed ingredients and research. Green Vibrance has been continuously improved more than 20 times since 1992. Every refinement is driven by evolving research to deliver real, measurable results you can trust."},{label:"Made in USA",view:"right",textAngle:62,modelRotationY:-90,highlightWidth:.5,description:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam nec metus nec ante placerat finibus."},{label:"Top View",view:"top",textAngle:0,description:"",hidden:!0}],et=`
    varying vec2 vUv;
    void main() {
        vUv = uv;
        gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
`,it=`
    uniform sampler2D map;
    uniform float uHighlightAngle; // Angle to highlight (radians), relative to texture center
    uniform vec3 uHighlightColor;
    uniform float uShowHighlight; // 0.0 = no highlight, 1.0 = highlight
    uniform vec3 uBaseColor; // Base color tint for the texture
    uniform float uHighlightWidth; // Width of highlight in radians
    varying vec2 vUv;

    // Constants
    const float PI = 3.14159265;
    const float TWO_PI = 6.28318530;

    void main() {
        vec4 texColor = texture2D(map, vUv);
        
        // Only affect non-transparent pixels
        if (texColor.a < 0.1) discard; 

        // Calculate angle of current pixel
        vec2 centered = vUv - 0.5;
        float angle = atan(centered.y, centered.x); // -PI to PI
        
        // Calculate distance to highlight angle
        float dist = abs(angle - uHighlightAngle);
        if (dist > PI) dist = TWO_PI - dist; // Wrap around

        vec3 finalColor = texColor.rgb * uBaseColor; // Apply base color tint
        
        // If within width, use highlight color
        if (uShowHighlight > 0.5 && dist < uHighlightWidth) {
            finalColor = uHighlightColor;
        }

        gl_FragColor = vec4(finalColor, texColor.a);
    }
`;class ot{constructor(o,e){this.rawModel=null,this.textRingMesh=null,this.clock=new F,this.mixer=null,this.animationAction=null,this.capMesh=null,this.capMaxY=0,this.capStartY=0,this.pendingRotationIndex=-1,this.targetTextRotation=39*Math.PI/180,this.textRotationOffset=39*Math.PI/180,this.isAutoRotating=!0,this.targetQuaternion=null,this.targetZoom=1,this.baseScale=1,this.currentModelZoom=1,this.animationId=null,this.animationTimeout=null,this.currentSectionIndex=-1,this.isLongSpin=!1,this.handleResize=()=>{if(!this.container||!this.camera||!this.renderer)return;const t=this.container.clientWidth,s=this.container.clientHeight,n=t/s,i=11;this.camera.left=-i*n/2,this.camera.right=i*n/2,this.camera.top=i/2,this.camera.bottom=-i/2,this.camera.updateProjectionMatrix(),this.renderer.setSize(t,s),this.composer.setSize(t,s)},this.animate=()=>{this.animationId=requestAnimationFrame(this.animate);const t=this.clock.getDelta();if(this.mixer&&(this.mixer.update(t),this.capMesh&&this.capMesh.material instanceof b)){const n=this.capMesh.position.y,i=this.capStartY,l=this.capMaxY>i?this.capMaxY:i+1,a=i+(l-i)*.05,r=i+(l-i)*.5,c=C.clamp((n-a)/(r-a),0,1);this.capMesh.material.opacity=1-c,this.pendingRotationIndex!==-1&&n>=r&&(console.log("Triggering Rotation at Height:",n),this.rotateToSection(this.pendingRotationIndex),this.pendingRotationIndex=-1)}if(this.modelContainer){if(this.isAutoRotating)this.modelContainer.rotation.y+=.3*t;else if(this.targetQuaternion){const n=1-Math.exp(-5*t);this.modelContainer.quaternion.slerp(this.targetQuaternion,n)}}const s=this.targetZoom-this.currentModelZoom;if(Math.abs(s)>.001){const n=1-Math.exp(-3*t);if(this.currentModelZoom+=s*n,this.modelContainer&&this.baseScale>0){const i=this.baseScale*this.currentModelZoom;this.modelContainer.scale.set(i,i,i)}}if(this.textRingMesh)if(this.isAutoRotating)this.textRingMesh.rotation.z-=.12*t;else{let n=this.textRingMesh.rotation.z,i=this.targetTextRotation-n;if(!this.isLongSpin){for(;i>Math.PI;)i-=Math.PI*2;for(;i<-Math.PI;)i+=Math.PI*2}const l=this.isLongSpin?2:5,a=1-Math.exp(-l*t);this.textRingMesh.rotation.z+=i*a}this.composer.render()},this.container=o,this.init(e)}init(o){const e=this.container.clientWidth*2,t=this.container.clientHeight*2;console.log(e,t),console.log(window.devicePixelRatio),this.scene=new O;const s=11,n=e/t;this.camera=new W(-s*n/2,s*n/2,s/2,-s/2,.1,100),this.camera.position.set(0,0,6),this.camera.lookAt(0,0,0),this.renderer=new _({antialias:!0,alpha:!0}),this.renderer.setSize(e,t),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.outputColorSpace=M,this.container.appendChild(this.renderer.domElement),this.composer=new $(this.renderer);const i=new V(this.scene,this.camera,0,0);i.sampleLevel=2,this.composer.addPass(i);const l=new D;this.composer.addPass(l),this.composer.setSize(e,t),this.composer.setPixelRatio(window.devicePixelRatio);const a=new U(16777215,1);this.scene.add(a);const r=new y(16777215,1.5);r.position.set(10,20,10),this.scene.add(r);const c=new y(16777215,1);c.position.set(-10,10,-10),this.scene.add(c),this.modelContainer=new S,this.scene.add(this.modelContainer),this.loadRings(),this.loadModel(o),this.animate(),window.addEventListener("resize",this.handleResize)}loadRings(){const o=new B,e=new S;[{path:"/images/vh-microsite-model-outer-ring.svg",size:10.6,isText:!1},{path:"/images/vh-microsite-model-text.svg",size:10,isText:!0},{path:"/images/vh-microsite-model-inner-ring.svg",size:9.4,isText:!1}].forEach(s=>{o.load(s.path,n=>{n.colorSpace=M;const i=new G(s.size,s.size);let l;if(s.isText){l=new Z({uniforms:{map:{value:n},uHighlightAngle:{value:0},uHighlightColor:{value:new I(11342)},uShowHighlight:{value:0},uBaseColor:{value:new I(11184810)},uHighlightWidth:{value:.8}},vertexShader:et,fragmentShader:it,transparent:!0,side:A,depthWrite:!1});const a=new w(i,l);this.textRingMesh=a,this.textRingMesh.rotation.z=this.targetTextRotation,this.updateHighlightUniform(-1),e.add(a)}else{l=new Q({map:n,transparent:!0,side:A,depthWrite:!1,color:11184810});const a=new w(i,l);e.add(a)}})}),e.position.y=0,e.position.z=-2,this.scene.add(e)}loadModel(o){new j().load(o,t=>{if(this.rawModel=t.scene,t.animations&&t.animations.length>0){this.mixer=new N(this.rawModel);const a=t.animations[0];this.animationAction=this.mixer.clipAction(a),this.animationAction.setLoop(R,1),this.animationAction.clampWhenFinished=!0,this.animationAction.timeScale=4,a.tracks.forEach(r=>{if(r.name.toLowerCase().includes(".position"))for(let c=1;c<r.values.length;c+=3)r.values[c]>this.capMaxY&&(this.capMaxY=r.values[c])}),console.log("Calculated Cap Max Y:",this.capMaxY)}const s=new q().setFromObject(this.rawModel),n=s.getSize(new g),i=s.getCenter(new g);this.rawModel.position.sub(i),this.modelContainer.add(this.rawModel);const l=Math.max(n.x,n.y,n.z);if(l>0){const a=7.2/l;this.baseScale=a,this.modelContainer.scale.set(a,a,a)}this.rawModel.traverse(a=>{if(a instanceof w){a.name.toLowerCase().includes("cap")&&(this.capMesh=a,this.capMesh.material instanceof b&&(this.capMesh.material.transparent=!0,this.capMesh.material.opacity=1,this.capStartY=this.capMesh.position.y));const r=a.material;if(r){const c=x=>{x&&(x.anisotropy=this.renderer.capabilities.getMaxAnisotropy())};c(r.map),c(r.emissiveMap),c(r.roughnessMap),c(r.metalnessMap),c(r.normalMap),r.normalMap&&(r.normalMap.flipY=!1),c(r.alphaMap),c(r.aoMap),c(r.clearcoatMap),c(r.clearcoatRoughnessMap),c(r.transmissionMap)}}})},void 0,t=>{console.error("An error happened loading the GLB",t)})}setSection(o){if(this.isAutoRotating=!1,!this.modelContainer)return;const e=o===p.length-1,t=this.currentSectionIndex===p.length-1;if(e){if(this.animationAction){this.animationAction.reset(),this.animationAction.timeScale=4,this.animationAction.play(),this.pendingRotationIndex=o,this.animationTimeout&&(clearTimeout(this.animationTimeout),this.animationTimeout=null),this.updateHighlightUniform(-1);return}}else t?(this.animationAction&&(this.animationAction.paused=!1,this.animationAction.timeScale=-4,this.animationAction.setLoop(R,1),this.animationAction.clampWhenFinished=!0,this.animationAction.play()),this.pendingRotationIndex=-1):(this.animationAction&&this.animationAction.isRunning()&&this.animationAction.stop(),this.pendingRotationIndex=-1);this.currentSectionIndex=o,this.rotateToSection(o)}rotateToSection(o){if(!this.modelContainer)return;const e=p[o];if(e.isIdle){this.isAutoRotating=!0,this.updateHighlightUniform(-1);return}const t=e.view,n=new m().setFromQuaternion(this.modelContainer.quaternion,"YXZ").y,i=new P().setFromAxisAngle(new g(0,1,0),n),l=new P;if(e.modelRotationY!==void 0){const a=C.degToRad(e.modelRotationY);l.setFromEuler(new m(0,a,0))}else switch(t){case"front":l.setFromEuler(new m(0,0,0));break;case"back":l.setFromEuler(new m(0,Math.PI,0));break;case"left":l.setFromEuler(new m(0,-Math.PI/2,0));break;case"right":l.setFromEuler(new m(0,Math.PI/2,0));break;case"top":l.setFromAxisAngle(new g(1,0,0),Math.PI/2).multiply(i);break;case"bottom":l.setFromAxisAngle(new g(1,0,0),-Math.PI/2).multiply(i);break}if(this.targetQuaternion=l,e.view==="top"&&this.textRingMesh)this.targetTextRotation=this.textRingMesh.rotation.z-Math.PI,this.isLongSpin=!0;else{const a=e.textAngle*Math.PI/180;this.targetTextRotation=-a+this.textRotationOffset,this.isLongSpin=!1}t==="top"||t==="bottom"||o===p.length-1?(this.updateHighlightUniform(-1),this.targetZoom=1.7):(this.updateHighlightUniform(o),this.targetZoom=1)}updateHighlightUniform(o){if(!this.textRingMesh)return;const e=this.textRingMesh.material;if(!e.uniforms)return;if(o<0){e.uniforms.uShowHighlight.value=0;return}e.uniforms.uShowHighlight.value=1;const t=p[o];e.uniforms.uHighlightWidth.value=t.highlightWidth??.8;const s=t.textAngle*Math.PI/180,n=this.textRotationOffset;let i=Math.PI/2+s-n;for(;i>Math.PI;)i-=Math.PI*2;for(;i<-Math.PI;)i+=Math.PI*2;e.uniforms.uHighlightAngle.value=i}dispose(){this.animationId&&cancelAnimationFrame(this.animationId),window.removeEventListener("resize",this.handleResize),this.renderer.dispose()}}var nt=Object.defineProperty,st=Object.getOwnPropertyDescriptor,u=(h,o,e,t)=>{for(var s=t>1?void 0:t?st(o,e):o,n=h.length-1,i;n>=0;n--)(i=h[n])&&(s=(t?i(o,e,s):i(s))||s);return t&&s&&nt(o,e,s),s};let d=class extends L{constructor(){super(...arguments),this.modelPath="/3d-models/vibranthealth_bottle_v2/VibrantHealth_Anim_JustBottle_Fix.glb",this.currentSectionIndex=-1,this.controlsVisible=!1,this.sceneManager=null,this.sections=p,this.observer=null,this.isProgrammaticScroll=!1,this.scrollTimeout=null}firstUpdated(){this.container&&(this.sceneManager=new ot(this.container,this.modelPath));const h={root:null,rootMargin:"-50% 0px -50% 0px",threshold:0};this.observer=new IntersectionObserver(o=>{this.isProgrammaticScroll||o.forEach(e=>{if(e.isIntersecting){const t=Number(e.target.getAttribute("data-index"));if(!isNaN(t)){const s=this.sections[t]?.hidden,n=!this.controlsVisible;n&&!s?this.controlsVisible=!0:s&&(this.controlsVisible=!1),(n||this.currentSectionIndex!==t)&&(this.currentSectionIndex=t,this.sceneManager&&this.sceneManager.setSection(t))}}})},h),this.sectionElements.forEach(o=>{this.observer?.observe(o)})}disconnectedCallback(){super.disconnectedCallback(),this.sceneManager&&this.sceneManager.dispose(),this.observer&&this.observer.disconnect()}handleSectionClick(h){if(this.currentSectionIndex===h)return;this.isProgrammaticScroll=!0,this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.currentSectionIndex=h,this.sceneManager&&this.sceneManager.setSection(h);const o=this.sectionElements[h];o&&o.scrollIntoView({behavior:"smooth"}),this.scrollTimeout=window.setTimeout(()=>{this.isProgrammaticScroll=!1},1e3)}render(){const h=this.sections[this.currentSectionIndex]||this.sections[0];return v`
            <div class="wrapper">
                <div class="model-wrapper">
                    <div class="vh-microsite-interactive-model"></div>
                    
                    <div class="controls-list ${this.controlsVisible?"visible":""}">
                        ${this.sections.map((o,e)=>o.hidden?null:v`
                                <button 
                                    class="control-item ${this.currentSectionIndex===e?"active":""}"
                                    @click=${()=>this.handleSectionClick(e)}
                                >
                                    <div class="icon">
                                        <img src="/images/vh-microsite-model-checkmark.svg" alt="Checkmark" />
                                    </div>
                                    <span class="label">${o.label}</span>
                                </button>
                            `)}
                    </div>

                    <div class="info-card ${this.controlsVisible?"visible":""}">
                        <div class="card-header">
                            <img src="/images/vh-microsite-model-checkmark.svg" alt="Checkmark" />
                            <h3>${h.label}</h3>
                        </div>
                        <p>${h.description}</p>
                    </div>
                </div>

                ${this.sections.map((o,e)=>v`
                    <div class="section" data-index="${e}"></div>
                `)}
            </div>
        `}};d.styles=T`
    ${k(tt)}
  `;u([H({type:String})],d.prototype,"modelPath",2);u([J(".vh-microsite-interactive-model")],d.prototype,"container",2);u([K(".section")],d.prototype,"sectionElements",2);u([z()],d.prototype,"currentSectionIndex",2);u([z()],d.prototype,"controlsVisible",2);d=u([Y("vh-microsite-interactive-model")],d);const ct={title:"Components/Interactive Model",component:"vh-microsite-interactive-model",tags:["autodocs"],argTypes:{modelPath:{control:"text"}}},f={render:()=>v`<div style="width: 100%; height: 600px;">
      <vh-microsite-interactive-model></vh-microsite-interactive-model>
    </div>`};f.parameters={...f.parameters,docs:{...f.parameters?.docs,source:{originalSource:`{
  render: () => html\`<div style="width: 100%; height: 600px;">
      <vh-microsite-interactive-model></vh-microsite-interactive-model>
    </div>\`
}`,...f.parameters?.docs?.source}}};const ht=["Default"];export{f as Default,ht as __namedExportsOrder,ct as default};
